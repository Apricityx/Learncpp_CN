# 1.8 空白和代码基本格式

空白（Whitespace）这个术语，指的是那些出于排版目的而使用的空白字符。在 C++ 中，空白指的是空格符、制表符和换行符。C++ 编译器通常会忽略空白（处理文本字面量时是一个特例）。因此我们可以说 C++ 是一个空格无关（whitespace-independent）的语言。

因此，下面几行代码的效果其实是完全一样的：

```cpp
std::cout << "Hello world!";

std::cout               <<            "Hello world!";

		std::cout << 		"Hello world!";

std::cout
	<< "Hello world!";
```

最后一个语句即使被分割为两行，它也能够正常编译。

下面的函数效果也完全一样：

```cpp
int add(int x, int y) { return x + y; }

int add(int x, int y) {
    return x + y; }

int add(int x, int y)
{    return x + y; }

int add(int x, int y)
{
    return x + y;
}
```

一个例外是，C++编译器并不会忽略引号包裹的字符串中的空白，例如 `"Hello world!"`。

```
"Hello world!"
```

上面的字符串和下面的字符串是不一样的。

```
"Hello     world!"
```

两个字符串都会被原封不动的打印处理。

在引号包裹的字符串中，换行是不合法的：

```cpp
std::cout << "Hello
     world!"; // Not allowed!
```

只使用空白字符（空格、换行和回车）分割的文本，最终将会被连接在一起：

```cpp
std::cout << "Hello "
     "world!"; // prints "Hello world!"
```

另外一个特例是，C++ 的编译器会关注单行注释（`//`）中的空白符。单行注释只会到该行末尾截止，下面的代码是有问题的：

```cpp
std::cout << "Hello world!"; // Here is a single-line comment
this is not part of the comment
```


## 基本代码格式

和其他语言不同，C++ 并不会强制程序员使用某种排版风格（还记得吗？相信程序员！）。C++ 中有很多可以使用的排版方式，关于哪一种才是最佳的方式，你可能会有不同的看法。我们的基本原则是，代码可读性最强、一执行最好的那种排版风格，就是最好的。 

本教程建议的排版规范如下：

1.使用制表符和空格进行缩进都是允许的 (大多数的 IDE 都可以设置自动将制表符转换为规定个数的空格）。开发者使用空格进行排版尤其内在的逻辑，毕竟使用”空格“来创建代码之间的”空白“是天经地义的。使用空格添加的空白，不论在什么编辑器下，看起来都是一致的。而使用制表符进行缩进的程序员会对上述行为感到困惑，制表符就是为了缩进而存在的，为什么不用呢？更何况你还可以自由控制其缩进的宽度。这个问题没有所谓”正确“的答案，争论它的对错是没有意义的，就好比争论粽子应该是甜的还是咸的，因为这完全取决于你自己的口味。

不论那种方式，我们建议你使用4个空格的宽度作为缩进的宽度。有些IDE默认的缩进宽度是3个空格，其实也是可以的。

2.函数括号的排版有两种可以接受的方式。

Google C++ 风格指南建议的风格是花括号不换行：

```cpp
int main() {
}
```

这么做的依据是，它能够减少纵向空白的产生（括号单独占用一行是不划算的），这样你就可以在有限的屏幕中显示更多的代码，这能够帮助你更好的理解代码。

不过，我们还是倾向于使用另外一种常见的方式，即大括号另起一行：

```cpp
int main()
{
}
```

这么做可以增强可读性，因为一对大括号总是具有相同的缩进，这么做可以减少犯错的几率。如果编译器报告了括号不匹配的错误，那你可以很容易的找到问题所在。

3.每一层大括号中的语句都必须进行缩进一级，例如：

```cpp
int main()
{
    std::cout << "Hello world!\n"; // tabbed in one tab (4 spaces)
    std::cout << "Nice to meet you.\n"; // tabbed in one tab (4 spaces)
}
```

4.每一行代码都不应该太长。常见的规则是：单行不能超过80个字符。如果一行代码太长，它就应当被分割为多行（在合适的位置分割）。具体操作时可以将各个子行额外缩进一级，或者，如果子行之间非常类似，可以将它们都对齐到上面的行（可读性更好）。

```cpp
int main()
{
    std::cout << "This is a really, really, really, really, really, really, really, "
        "really long line\n"; // one extra indentation for continuation line

    std::cout << "This is another really, really, really, really, really, really, really, "
                 "really long line\n"; // text aligned with the previous line for continuation line

    std::cout << "This one is short\n";
}
```

这么做可以使得每行代码都具有很好的可读性。在宽屏显示器上，这么做还可以允许你将两个代码窗口并排显示，轻松地对比它们的差异。

> [!TIP] 最佳实践
> 单行代码长度不应该超过80个字符。

> [!TIP] 小贴士
> 很多编辑器都集成（或通过插件/扩展）了列指示器，能够显示出你当前所处的列的位置。因此你可以很容易地判断你的代码行是不是超长了。To see if your editor supports this, do a search on your editor’s name + “Column guide”.

5.  If a long line is split with an operator (eg. << or +), the operator should be placed at the beginning of the next line, not the end of the current line

```cpp
std::cout << 3 + 4
    + 5 + 6
    * 7 * 8;
```

This helps make it clearer that subsequent lines are continuations of the previous lines, and allows you to align the operators on the left, which makes for easier reading.

6.  Use whitespace to make your code easier to read by aligning values or comments or adding spacing between blocks of code.

Harder to read:

```cpp
cost = 57;
pricePerItem = 24;
value = 5;
numberOfItems = 17;
```

COPY

Easier to read:

```cpp
cost          = 57;
pricePerItem  = 24;
value         = 5;
numberOfItems = 17;
```

Harder to read:

```cpp
std::cout << "Hello world!\n"; // cout lives in the iostream library
std::cout << "It is very nice to meet you!\n"; // these comments make the code hard to read
std::cout << "Yeah!\n"; // especially when lines are different lengths
```

Easier to read:

```cpp
std::cout << "Hello world!\n";                  // cout lives in the iostream library
std::cout << "It is very nice to meet you!\n";  // these comments are easier to read
std::cout << "Yeah!\n";                         // especially when all lined up
```

Harder to read:

```cpp
// cout lives in the iostream library
std::cout << "Hello world!\n";
// these comments make the code hard to read
std::cout << "It is very nice to meet you!\n";
// especially when all bunched together
std::cout << "Yeah!\n";
```

Easier to read:

```cpp
// cout lives in the iostream library
std::cout << "Hello world!\n";

// these comments are easier to read
std::cout << "It is very nice to meet you!\n";

// when separated by whitespace
std::cout << "Yeah!\n";
```

We will follow these conventions throughout this tutorial, and they will become second nature to you. As we introduce new topics to you, we will introduce new style recommendations to go with those features.

Ultimately, C++ gives you the power to choose whichever style you are most comfortable with, or think is best. However, we highly recommend you utilize the same style that we use for our examples. It has been battle tested by thousands of programmers over billions of lines of code, and is optimized for success. One exception: If you are working in someone else’s code base, adopt their styles. It’s better to favor consistency than your preferences.

## Automatic formatting

Most modern IDEs will help you format your code as you type it in (e.g. when you create a function, the IDE will automatically indent the statements inside the function body).

However, as you add or remove code, or change the IDE’s default formatting, or paste in a block of code that has different formatting, the formatting can get messed up. Fixing the formatting for part or all of a file can be a headache. Fortunately, modern IDEs typically contain an automatic formatting feature that will reformat either a selection (highlighted with your mouse) or an entire file.

> [!TIP] 小贴士
> #### For Visual Studio users

In Visual Studio, the automatic formatting options can be found under _Edit > Advanced > Format Document_ and _Edit > Advanced > Format Selection_.

> [!TIP] 小贴士
> #### For Code::Blocks users
> In Code::Blocks, the automatic formatting options can be found under _Right mouse click > Format use AStyle_.

For easier access, we recommend adding a keyboard shortcut to auto-format the active file.

> [!TIP] 小贴士
> Using the automatic formatting feature is highly recommended to keep your code’s formatting style consistent.